$(function () {	var $searchInput = $('#searchInput');	var $searchPanel = $('#searchPanel');	var $searchLable = $('#searchLable');	var $searchList = $('#searchList');    //输入框提醒字    var $tipsInput = $('.tipsInput');    $tipsInput.focus(function () {        var $this = $(this);        var $default = $this.attr('defaultText');        var val = $this.val();        if ($default == val) { $this.val(""); $this.css("color", "#333"); }    }).blur(function () {        var $this = $(this);        var $default = $this.attr('defaultText');        var val = $this.val();        if (val == "") { $this.val($default); $this.css("color", "#CCC"); }    });    //搜索框悬浮    $searchPanel.hover(function () {        $searchPanel.addClass('search-panel-fields-selected');    }, function () {        $searchPanel.removeClass('search-panel-fields-selected');        $searchList.hide();    });    //搜索框键入,自动完成    var $hotLine = $('#hotLine');    var $autoComplete = $('#autoComplete');    var keycount = 1;    //搜索框获取焦点    $searchInput.focus(function () {        $searchLable.hide();        $searchList.show();    }).blur(function () {		searchblur();    }).change(function (event) {        $hotLine.hide();		searchblur();        $autoComplete.show();        $searchInput.unbind("keyup");        $searchInput.bind("keyup", onsearchkeyup);        var charcode = ((event || window.event).keyCode);        if (charcode == 13) {            $("#aspnetForm").attr({ "action": geturl(), "method": "post" }).submit();            //gosearch();            return;        }    });	function searchblur(){		if ($searchInput.val() == "") {            $searchLable.show();            $hotLine.show();            //$autoComplete.hide();        }	}    //    .keyup(function () {    //        $(this).unbind("keyup", onsearchkeyup);    //        var charcode = ((event || window.event).keyCode);    //        onsearchkeyup(charcode, $.trim($(this).val()));    //        //$(this).bind("keyup", onsearchkeyup);    //    });    function onsearchkeyup() {        var isshow = true;        /*if (isshow) {        var charcode = ((event || window.event).keyCode);        if (charcode == 8 || charcode == 16 || charcode == 17 || charcode == 18 || charcode == 32 || charcode == 46 || keycount > 3) {        isshow = true;        keycount = 0;        }        else {        keycount++;        isshow = false;        }        }*/        if (isshow) {            if ($.trim($(this).val()) == "") {                isshow = false;            }        }        if (!isshow) {            $hotLine.show();            $autoComplete.hide();            $("#autoCompleteshow").hide();            return;        }        var tb = $("#tblist");        tb.empty();        //var type = gettype();        $.ajax({            url: '/AjaxHandler/AutoComplete.aspx',            type: "post",            async: true,            data: "null",            beforeSend: function () { tb.empty(); $("#preloader").show(); },            success: function (data) {                var models = eval("(" + data + ")");                if (models.length > 0) {                    tb.find("tr[name=nodata]").remove();                    var indextr = 0;                    for (var i = 0; i < models.length; i++) {                        var model = models[i];                        if (model != null && model != undefined) {                            if (model.Name != undefined && model.Name != "") {                                if (tb.find("tr[name='" + escape(model.Name) + "']").size() == 0) {                                    tb.append("<tr name='" + escape(model.Name) + "'><td  valign=\"top\"><a href='#' onclick='$(\"#searchInput\").val(\"" + model.Name + "\"); $(\"#autoCompleteshow\").hide();gosearch();'>" + model.Name + "</a></td></tr>");                                    indextr++;                                    if (indextr == 15)                                        break;                                }                            }                        }                    }                }                else {                    if (tb.find("tr").size() == 0)                        tb.append("<tr name='nodata'><td valign=\"top\">找不到相关数据</td></tr>");                }                $("#autoCompleteshow").show("fast", "swing");                $autoComplete.hide();            },            complete: function () {                $("#preloader").hide();            },            error: function (a, b, c) {                if (tb.find("tr").size() == 0)                    tb.append("<tr><td valign=\"top\">找不到相关数据</td></tr>");                $("#autoCompleteshow").show("fast", "swing");                $autoComplete.hide();            }        });    }    //搜索框点击隐藏灰色字    $searchLable.click(function () {        $searchInput.focus();    });    //搜索框下拉菜单    $searchSelectedContent = $('#searchSelectedContent');    $searchTab = $('#searchTab');    $searchLi = $('#searchTab ul li');    $searchSelected = $('#searchSelected');    //搜索框选择框悬浮    $searchSelectedContent.hover(function () {        $searchTab.show();        $searchList.hide();        $searchSelected.addClass('searchSelectedUp');    }, function () {        $searchTab.hide();        $searchSelected.removeClass('searchSelectedUp');    });    //搜索框列表悬浮    $searchLi.hover(function () {        $(this).addClass('selected');    }, function () {        $(this).removeClass('selected');    });    //搜索框列表点击    $searchLi.click(function () {        $searchSelected.text($(this).text());    });    $("a[name=searcha]").click(function () { $("#searchLable").empty(); $("#searchInput").val($(this).text()); gosearch(); });    //问题显示隐藏    $('.quz').hover(function () { $(this).find('#tms').stop(true, false).fadeIn(300); $(this).find('#tms').css("opacity", "1"); }, function () { $(this).stop(true, false).find('#tms').fadeOut(300); });    //页头登陆显示    $.ajax({        url: '/Users/AjaxHandler/LoginCheck.aspx',        type: "post",        async: true,        data: "checktype=getinfouser",        success: function (data) {            var models = eval("(" + data + ")");            if (models.UserID > 0) {                $("a[group=nonlogin]").hide();                $("a[group=haslogin]").show();                $("#alogined").html("您好," + models.UserName);                $("#asignout").click(function () {                    $.ajax({                        url: '/Users/AjaxHandler/LoginCheck.aspx',                        type: "post",                        async: true,                        data: "checktype=signout",                        success: function (data) {                            window.location.href = "/default.html";                        },                        error: function (a, b, c) {                        }                    });                });            }            else {                $("a[group=nonlogin]").show();                $("a[group=haslogin]").hide();            }        },        error: function (a, b, c) {        }    });	//$('#mainSearchBar').append($('#searchBar').clone(true));});function geturl(){    return "/subject/140227_mdv_hotels/index.html/!#/?key=" + escape($("#searchInput").val())+'&page=0';}urlPostServer();function urlPostServer(){	var page=getPara().page;	var key=getPara().key;	$('#mainContent').html('');			//console.log(search.match(keyPattern)[1],page);	loadingProccess();	ajaxLoader({key:key,pageIdx:page});	$searchInput.val(key);}function gosearch() {	    window.location.href = geturl();	urlPostServer();	checkKey();}